<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>插件 | Goldfish</title>
    <meta name="description" content="支付宝小程序开发框架">
    <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="icon" href="https://gw-office.alipayobjects.com/basement_prod/dc20c631-5c76-4c71-880a-155ec0b108de.png">
    
    <link rel="preload" href="/goldfish/assets/css/0.styles.8c71cc46.css" as="style"><link rel="preload" href="/goldfish/assets/js/app.1d07effa.js" as="script"><link rel="preload" href="/goldfish/assets/js/3.ecc071d1.js" as="script"><link rel="preload" href="/goldfish/assets/js/52.1266f369.js" as="script"><link rel="prefetch" href="/goldfish/assets/js/10.0ad14131.js"><link rel="prefetch" href="/goldfish/assets/js/11.21725e47.js"><link rel="prefetch" href="/goldfish/assets/js/12.b3bbcba4.js"><link rel="prefetch" href="/goldfish/assets/js/13.121e0f16.js"><link rel="prefetch" href="/goldfish/assets/js/14.cf89a597.js"><link rel="prefetch" href="/goldfish/assets/js/15.cf4d5dc4.js"><link rel="prefetch" href="/goldfish/assets/js/16.9d24cf52.js"><link rel="prefetch" href="/goldfish/assets/js/17.b7e00d5b.js"><link rel="prefetch" href="/goldfish/assets/js/18.e891411d.js"><link rel="prefetch" href="/goldfish/assets/js/19.4b57cd67.js"><link rel="prefetch" href="/goldfish/assets/js/20.758d5861.js"><link rel="prefetch" href="/goldfish/assets/js/21.964c4f91.js"><link rel="prefetch" href="/goldfish/assets/js/22.45f0c279.js"><link rel="prefetch" href="/goldfish/assets/js/23.268e4739.js"><link rel="prefetch" href="/goldfish/assets/js/24.0a50b5de.js"><link rel="prefetch" href="/goldfish/assets/js/25.0f5afb30.js"><link rel="prefetch" href="/goldfish/assets/js/26.5544c03f.js"><link rel="prefetch" href="/goldfish/assets/js/27.c6a28a5f.js"><link rel="prefetch" href="/goldfish/assets/js/28.29cd99e7.js"><link rel="prefetch" href="/goldfish/assets/js/29.ee68b291.js"><link rel="prefetch" href="/goldfish/assets/js/30.82ac8eb8.js"><link rel="prefetch" href="/goldfish/assets/js/31.aab59648.js"><link rel="prefetch" href="/goldfish/assets/js/32.cc200fed.js"><link rel="prefetch" href="/goldfish/assets/js/33.b832e40a.js"><link rel="prefetch" href="/goldfish/assets/js/34.1c853da6.js"><link rel="prefetch" href="/goldfish/assets/js/35.a46095d8.js"><link rel="prefetch" href="/goldfish/assets/js/36.e015f2b3.js"><link rel="prefetch" href="/goldfish/assets/js/37.ac7d045b.js"><link rel="prefetch" href="/goldfish/assets/js/38.f2ba1b02.js"><link rel="prefetch" href="/goldfish/assets/js/39.73adb974.js"><link rel="prefetch" href="/goldfish/assets/js/4.2fff6b7c.js"><link rel="prefetch" href="/goldfish/assets/js/40.37d34b66.js"><link rel="prefetch" href="/goldfish/assets/js/41.17b2f6d9.js"><link rel="prefetch" href="/goldfish/assets/js/42.a58cc49c.js"><link rel="prefetch" href="/goldfish/assets/js/43.0cf82599.js"><link rel="prefetch" href="/goldfish/assets/js/44.95db13a4.js"><link rel="prefetch" href="/goldfish/assets/js/45.c5d88ec6.js"><link rel="prefetch" href="/goldfish/assets/js/46.786e29ae.js"><link rel="prefetch" href="/goldfish/assets/js/47.fd21942c.js"><link rel="prefetch" href="/goldfish/assets/js/48.daa7cac5.js"><link rel="prefetch" href="/goldfish/assets/js/49.cadd6e3d.js"><link rel="prefetch" href="/goldfish/assets/js/5.04ed2142.js"><link rel="prefetch" href="/goldfish/assets/js/50.8dd4949a.js"><link rel="prefetch" href="/goldfish/assets/js/51.cd197a66.js"><link rel="prefetch" href="/goldfish/assets/js/53.21f6fbd8.js"><link rel="prefetch" href="/goldfish/assets/js/54.ad680b74.js"><link rel="prefetch" href="/goldfish/assets/js/55.e08b7433.js"><link rel="prefetch" href="/goldfish/assets/js/56.d3fd457a.js"><link rel="prefetch" href="/goldfish/assets/js/57.41c62168.js"><link rel="prefetch" href="/goldfish/assets/js/58.60884e35.js"><link rel="prefetch" href="/goldfish/assets/js/59.27ca1e24.js"><link rel="prefetch" href="/goldfish/assets/js/6.16a181e5.js"><link rel="prefetch" href="/goldfish/assets/js/60.c07d60de.js"><link rel="prefetch" href="/goldfish/assets/js/61.2e308709.js"><link rel="prefetch" href="/goldfish/assets/js/62.5e1fe8e4.js"><link rel="prefetch" href="/goldfish/assets/js/63.8f199324.js"><link rel="prefetch" href="/goldfish/assets/js/64.8a2a3345.js"><link rel="prefetch" href="/goldfish/assets/js/65.1878f02e.js"><link rel="prefetch" href="/goldfish/assets/js/66.5c7d5d4c.js"><link rel="prefetch" href="/goldfish/assets/js/67.2f5f7a7f.js"><link rel="prefetch" href="/goldfish/assets/js/68.44953b9b.js"><link rel="prefetch" href="/goldfish/assets/js/69.f6b13f43.js"><link rel="prefetch" href="/goldfish/assets/js/7.cddcfced.js"><link rel="prefetch" href="/goldfish/assets/js/70.ecd892b5.js"><link rel="prefetch" href="/goldfish/assets/js/71.f90050c0.js"><link rel="prefetch" href="/goldfish/assets/js/72.fedb73d6.js"><link rel="prefetch" href="/goldfish/assets/js/8.23ff84f3.js"><link rel="prefetch" href="/goldfish/assets/js/9.abb1d45d.js"><link rel="prefetch" href="/goldfish/assets/js/vendors~docsearch.e4765bfd.js">
    <link rel="stylesheet" href="/goldfish/assets/css/0.styles.8c71cc46.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/goldfish/zh/" class="home-link router-link-active"><!----> <span class="site-name">Goldfish</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/goldfish/zh/guide/" class="nav-link">Guide</a></div><div class="nav-item"><a href="/goldfish/zh/api/" class="nav-link router-link-active">API</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/goldfish/api/plugins.html" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/goldfish/zh/api/plugins.html" class="nav-link router-link-exact-active router-link-active">简体中文</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/goldfish/zh/guide/" class="nav-link">Guide</a></div><div class="nav-item"><a href="/goldfish/zh/api/" class="nav-link router-link-active">API</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/goldfish/api/plugins.html" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/goldfish/zh/api/plugins.html" class="nav-link router-link-exact-active router-link-active">简体中文</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/goldfish/zh/api/" class="sidebar-link">App</a></li><li><a href="/goldfish/zh/api/globalConfig.html" class="sidebar-link">全局配置</a></li><li><a href="/goldfish/zh/api/Page.html" class="sidebar-link">页面</a></li><li><a href="/goldfish/zh/api/Component.html" class="sidebar-link">组件</a></li><li><a href="/goldfish/zh/api/plugins.html" class="active sidebar-link">插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#插件管理" class="sidebar-link">插件管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#register-pluginclass" class="sidebar-link">register(PluginClass)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#get-pluginclass" class="sidebar-link">get(PluginClass)</a></li></ul></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#插件基类-plugin" class="sidebar-link">插件基类 Plugin</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#type" class="sidebar-link">type</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#init-getplugin" class="sidebar-link">init(getPlugin)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#destroy" class="sidebar-link">destroy()</a></li></ul></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#全局插件管理模块" class="sidebar-link">全局插件管理模块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#init" class="sidebar-link">init()</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#destroy-2" class="sidebar-link">destroy()</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#register-pluginclass-2" class="sidebar-link">register(PluginClass)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#get-pluginclass-2" class="sidebar-link">get(PluginClass)</a></li></ul></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#jsbridge-插件" class="sidebar-link">JSBridge 插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#pushwindow-url-params" class="sidebar-link">pushWindow(url, params?)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#getcurrentlocation-options" class="sidebar-link">getCurrentLocation(options)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#getstartupparams-options" class="sidebar-link">getStartupParams(options?)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#reportbizready" class="sidebar-link">reportBizReady()</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#getuserinfo" class="sidebar-link">getUserInfo()</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#getsysteminfo" class="sidebar-link">getSystemInfo()</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#getnetworktype" class="sidebar-link">getNetworkType()</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#getstorageitem-key" class="sidebar-link">getStorageItem(key)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#setstorageitem-key-value" class="sidebar-link">setStorageItem(key, value)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#getcurrenturl" class="sidebar-link">getCurrentUrl()</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#callbridge-api-args" class="sidebar-link">callBridge(api, ...args?)</a></li></ul></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#feedback-交互反馈插件" class="sidebar-link">Feedback 交互反馈插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#addtoast-options" class="sidebar-link">addToast(options)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#addalert-options" class="sidebar-link">addAlert(options)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#addconfirm-options" class="sidebar-link">addConfirm(options)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#addprompt-options" class="sidebar-link">addPrompt(options)</a></li></ul></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#requester-数据请求插件" class="sidebar-link">Requester 数据请求插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#requesttwa-api-params-options" class="sidebar-link">requestTWA(api, params?, options?)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#requesth5data-path-basementprojectname-options" class="sidebar-link">requestH5Data(path, basementProjectName, options?)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#sendrequest-url" class="sidebar-link">sendRequest(url)</a></li></ul></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#route-应用内路由插件" class="sidebar-link">Route 应用内路由插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#path" class="sidebar-link">path</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#query" class="sidebar-link">query</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#redirect-url-params" class="sidebar-link">redirect(url, params?)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#back-n-defaulturl" class="sidebar-link">back(n, defaultUrl?)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#backto-url-options" class="sidebar-link">backTo(url, options?)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#replace-url-params" class="sidebar-link">replace(url, params?)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#pushwindow-url-params-2" class="sidebar-link">pushWindow(url, params?)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#popwindow" class="sidebar-link">popWindow()</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#popto-delta" class="sidebar-link">popTo(delta)</a></li></ul></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#trace-业务埋点插件" class="sidebar-link">Trace 业务埋点插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#logpv-spmb-params" class="sidebar-link">logPv(spmb, params?)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#before-name-hookfn" class="sidebar-link">before(name, hookFn)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#call-methodname-args" class="sidebar-link">call(methodName, ...args)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#report-params" class="sidebar-link">report(params)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#get-key" class="sidebar-link">get(key)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#set-config" class="sidebar-link">set(config)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#click-spmid-extraparams" class="sidebar-link">click(spmId, extraParams?)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#expo-spmid-extraparams" class="sidebar-link">expo(spmId, extraParams?)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#pagestate-name" class="sidebar-link">pageState(name)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#info-params" class="sidebar-link">info(params)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#parse-value" class="sidebar-link">parse(value)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#stringify-value" class="sidebar-link">stringify(value)</a></li></ul></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#log-日志插件" class="sidebar-link">Log 日志插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#log-msg" class="sidebar-link">log(msg)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#warn-msg" class="sidebar-link">warn(msg)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#debug-msg" class="sidebar-link">debug(msg)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#error-msg" class="sidebar-link">error(msg)</a></li><li class="sidebar-sub-header"><a href="/goldfish/zh/api/plugins.html#reportduration-type-name-fn" class="sidebar-link">reportDuration(type, name, fn)</a></li></ul></li></ul></li><li><a href="/goldfish/zh/api/utils.html" class="sidebar-link">工具函数</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="插件"><a href="#插件" class="header-anchor">#</a> 插件</h1> <p>在全局模块 <code>AppStore</code> 中，提供了插件管理功能（<code>pluginHub</code>）。</p> <p>使用者可以注册自己的插件，也可以使用内置的插件：<a href="#jsbridge-%E6%8F%92%E4%BB%B6">JSBridge 插件</a>、<a href="#feedback-%E4%BA%A4%E4%BA%92%E5%8F%8D%E9%A6%88%E6%8F%92%E4%BB%B6">交互反馈插件</a>、<a href="#log-%E6%97%A5%E5%BF%97%E6%8F%92%E4%BB%B6">日志插件</a>、<a href="#requester-%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82%E6%8F%92%E4%BB%B6">数据请求插件</a>、<a href="#route-%E5%BA%94%E7%94%A8%E5%86%85%E8%B7%AF%E7%94%B1%E6%8F%92%E4%BB%B6">应用内路由插件</a>、<a href="#trace-%E4%B8%9A%E5%8A%A1%E5%9F%8B%E7%82%B9%E6%8F%92%E4%BB%B6">业务埋点插件</a>。</p> <p>内部插件可以通过 <code>usePlugins</code> 访问。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> setupPage<span class="token punctuation">,</span> usePlugins <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@alipay/goldfish'</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

<span class="token function">setupPage</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> plugins <span class="token operator">=</span> <span class="token function">usePlugins</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 调用插件 API</span>
  plugins<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span><span class="token function">getCurrentUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p></p><div class="table-of-contents"><ul><li><a href="#插件管理">插件管理</a><ul><li><a href="#register-pluginclass">register(PluginClass)</a></li><li><a href="#get-pluginclass">get(PluginClass)</a></li></ul></li><li><a href="#插件基类-plugin">插件基类 Plugin</a><ul><li><a href="#type">type</a></li><li><a href="#init-getplugin">init(getPlugin)</a></li><li><a href="#destroy">destroy()</a></li></ul></li><li><a href="#全局插件管理模块">全局插件管理模块</a><ul><li><a href="#init">init()</a></li><li><a href="#destroy">destroy()</a></li><li><a href="#register-pluginclass">register(PluginClass)</a></li><li><a href="#get-pluginclass">get(PluginClass)</a></li></ul></li><li><a href="#jsbridge-插件">JSBridge 插件</a><ul><li><a href="#pushwindow-url-params">pushWindow(url, params?)</a></li><li><a href="#getcurrentlocation-options">getCurrentLocation(options)</a></li><li><a href="#getstartupparams-options">getStartupParams(options?)</a></li><li><a href="#reportbizready">reportBizReady()</a></li><li><a href="#getuserinfo">getUserInfo()</a></li><li><a href="#getsysteminfo">getSystemInfo()</a></li><li><a href="#getnetworktype">getNetworkType()</a></li><li><a href="#getstorageitem-key">getStorageItem(key)</a></li><li><a href="#setstorageitem-key-value">setStorageItem(key, value)</a></li><li><a href="#getcurrenturl">getCurrentUrl()</a></li><li><a href="#callbridge-api-args">callBridge(api, ...args?)</a></li></ul></li><li><a href="#feedback-交互反馈插件">Feedback 交互反馈插件</a><ul><li><a href="#addtoast-options">addToast(options)</a></li><li><a href="#addalert-options">addAlert(options)</a></li><li><a href="#addconfirm-options">addConfirm(options)</a></li><li><a href="#addprompt-options">addPrompt(options)</a></li></ul></li><li><a href="#requester-数据请求插件">Requester 数据请求插件</a><ul><li><a href="#requesttwa-api-params-options">requestTWA(api, params?, options?)</a></li><li><a href="#requesth5data-path-basementprojectname-options">requestH5Data(path, basementProjectName, options?)</a></li><li><a href="#sendrequest-url">sendRequest(url)</a></li></ul></li><li><a href="#route-应用内路由插件">Route 应用内路由插件</a><ul><li><a href="#path">path</a></li><li><a href="#query">query</a></li><li><a href="#redirect-url-params">redirect(url, params?)</a></li><li><a href="#back-n-defaulturl">back(n, defaultUrl?)</a></li><li><a href="#backto-url-options">backTo(url, options?)</a></li><li><a href="#replace-url-params">replace(url, params?)</a></li><li><a href="#pushwindow-url-params">pushWindow(url, params?)</a></li><li><a href="#popwindow">popWindow()</a></li><li><a href="#popto-delta">popTo(delta)</a></li></ul></li><li><a href="#trace-业务埋点插件">Trace 业务埋点插件</a><ul><li><a href="#logpv-spmb-params">logPv(spmb, params?)</a></li><li><a href="#before-name-hookfn">before(name, hookFn)</a></li><li><a href="#call-methodname-args">call(methodName, ...args)</a></li><li><a href="#report-params">report(params)</a></li><li><a href="#get-key">get(key)</a></li><li><a href="#set-config">set(config)</a></li><li><a href="#click-spmid-extraparams">click(spmId, extraParams?)</a></li><li><a href="#expo-spmid-extraparams">expo(spmId, extraParams?)</a></li><li><a href="#pagestate-name">pageState(name)</a></li><li><a href="#info-params">info(params)</a></li><li><a href="#parse-value">parse(value)</a></li><li><a href="#stringify-value">stringify(value)</a></li></ul></li><li><a href="#log-日志插件">Log 日志插件</a><ul><li><a href="#log-msg">log(msg)</a></li><li><a href="#warn-msg">warn(msg)</a></li><li><a href="#debug-msg">debug(msg)</a></li><li><a href="#error-msg">error(msg)</a></li><li><a href="#reportduration-type-name-fn">reportDuration(type, name, fn)</a></li></ul></li></ul></div><p></p> <h2 id="插件管理"><a href="#插件管理" class="header-anchor">#</a> 插件管理</h2> <h3 id="register-pluginclass"><a href="#register-pluginclass" class="header-anchor">#</a> register(PluginClass)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{constructor} PluginClass</code></li></ul></li> <li><p><strong>返回值：</strong><code>{Promise&lt;void&gt;}</code></p></li> <li><p><strong>说明：</strong></p> <p>注册插件。</p> <p>插件应当是一个继承自 <code>Plugin</code> 的类。</p> <p>在应用初始化的时候，会初始化已经注册的插件。也可以在初始化完毕之后注册插件，此时当插件注册并初始化完成之后，<code>register()</code> 返回的 <code>promise</code> 对象才会变为 <code>resolved</code> 状态。</p></li> <li><p><strong>示例：</strong></p> <div class="language-ts line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> AppStore<span class="token punctuation">,</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@alipay/goldfish'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">'MyPlugin'</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">BizAppStore</span> <span class="token keyword">extends</span> <span class="token class-name">AppStore</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">registerMyPlugins</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pluginHub<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>MyPlugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 注册插件并初始化完毕</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li></ul> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>如果想在全局模块 <code>AppStore</code> 初始化的时候，完成自定义插件初始化，或者覆盖内置插件，可以在 <code>AppStore#getPlugins()</code> 钩子函数中返回所有插件类。</p></div> <h3 id="get-pluginclass"><a href="#get-pluginclass" class="header-anchor">#</a> get(PluginClass)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string | constructor} PluginClass</code></li></ul></li> <li><p><strong>返回值：</strong><code>{IModule} plugin</code></p></li> <li><p><strong>说明：</strong></p> <p>根据插件类型或者插件类，获取第一个已注册的插件对象。</p></li> <li><p><strong>示例：</strong></p> <div class="language-ts line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> AppStore<span class="token punctuation">,</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@alipay/goldfish'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">'MyPlugin'</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">BizAppStore</span> <span class="token keyword">extends</span> <span class="token class-name">AppStore</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">registerMyPlugins</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pluginHub<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>MyPlugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 注册插件并初始化完毕</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token function">getPluginByClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pluginHub<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>MyPlugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token function">getPluginByType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pluginHub<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token operator">&lt;</span>MyPlugin<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">'MyPlugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div></li></ul> <h2 id="插件基类-plugin"><a href="#插件基类-plugin" class="header-anchor">#</a> 插件基类 <code>Plugin</code></h2> <p>插件有统一的基类 <code>Plugin</code>，每个插件都应当继承自该类。</p> <div class="language-ts line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@alipay/goldfish'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">'MyPlugin'</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="type"><a href="#type" class="header-anchor">#</a> type</h3> <ul><li><p><strong>类型：</strong><code>string</code></p></li> <li><p><strong>说明：</strong></p> <p><code>type</code> 数据成员表明插件的类型，一个应用应当只能存在某一种类型的插件。</p></li></ul> <h3 id="init-getplugin"><a href="#init-getplugin" class="header-anchor">#</a> init(getPlugin)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{Function} getPlugin</code> 获取其它兄弟插件实例</li></ul></li> <li><p><strong>返回值：</strong><code>{Promise&lt;void&gt;}</code></p></li> <li><p><strong>说明：</strong></p> <p>生命周期方法，初始化插件。</p></li> <li><p><strong>示例：</strong></p> <div class="language-ts line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Plugin<span class="token punctuation">,</span> Plugin<span class="token punctuation">,</span> ILog<span class="token punctuation">,</span> JSBridge <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@alipay/goldfish'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">'MyPlugin'</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">getPlugin<span class="token punctuation">:</span> GetPlugin</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>getPlugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> log <span class="token operator">=</span> getPlugin<span class="token operator">&lt;</span>ILog <span class="token operator">&amp;</span> IModule<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">'log'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> bridge <span class="token operator">=</span> <span class="token function">getPlugin</span><span class="token punctuation">(</span>JSBridge<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ul> <h3 id="destroy"><a href="#destroy" class="header-anchor">#</a> destroy()</h3> <ul><li><p><strong>说明：</strong></p> <p>生命周期方法，销毁实例。</p></li></ul> <h2 id="全局插件管理模块"><a href="#全局插件管理模块" class="header-anchor">#</a> 全局插件管理模块</h2> <p>单独的全局插件管理模块。</p> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p><strong>注意：</strong></p> <p>主要用于已存项目，新项目不要使用。</p></div> <h3 id="init"><a href="#init" class="header-anchor">#</a> init()</h3> <ul><li><p><strong>说明：</strong></p> <p>生命周期方法，初始化全局插件管理模块。</p></li></ul> <h3 id="destroy-2"><a href="#destroy-2" class="header-anchor">#</a> destroy()</h3> <ul><li><p><strong>说明：</strong></p> <p>生命周期方法，销毁全局插件管理模块。</p></li></ul> <h3 id="register-pluginclass-2"><a href="#register-pluginclass-2" class="header-anchor">#</a> register(PluginClass)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{constructor} PluginClass</code></li></ul></li> <li><p><strong>返回值：</strong><code>{Promise&lt;void&gt;}</code></p></li> <li><p><strong>说明：</strong></p> <p>注册插件，当返回的 Promise 对象 resolved 之后，则说明插件已被成功注册。</p></li> <li><p><strong>示例：</strong></p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> JSBridge<span class="token punctuation">,</span> pluginHub <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@alipay/goldfish'</span><span class="token punctuation">;</span>

pluginHub<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>JSBridge<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul> <h3 id="get-pluginclass-2"><a href="#get-pluginclass-2" class="header-anchor">#</a> get(PluginClass)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{constructor} PluginClass</code></li></ul></li> <li><p><strong>返回值：</strong><code>{Promise&lt;Plugin&gt;}</code></p></li> <li><p><strong>说明：</strong></p> <p>获取已注册的插件。如果没找到指定插件，该方法会抛出异常。</p></li> <li><p><strong>示例：</strong></p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> pluginHub<span class="token punctuation">,</span> JSBridge <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@alipay/goldfish'</span><span class="token punctuation">;</span>

pluginHub<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>JSBridge<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">bridgePlugin</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// do something.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul> <h2 id="jsbridge-插件"><a href="#jsbridge-插件" class="header-anchor">#</a> JSBridge 插件</h2> <p>对容器 JS API 的封装，主要做以下提升：</p> <ol><li>屏蔽底层容器 API 的 bug；</li> <li>屏蔽底层容器 API 的繁琐度；</li> <li>提供更加友好的 Promise 风格 API。</li></ol> <h3 id="pushwindow-url-params"><a href="#pushwindow-url-params" class="header-anchor">#</a> pushWindow(url, params?)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string} url</code></li> <li><code>{Object} params</code></li></ul></li> <li><p><strong>返回值：</strong><code>{Promise&lt;void&gt;}</code></p></li> <li><p><strong>说明：</strong></p> <p>跳转内部 H5 页面或者应用，包括凤蝶页、离线包应用、小程序应用等。跳转成功之后，返回的 Promise 对象变为 resolved。</p> <p>跳转的时候，会带上全局配置中的 <code>chInfo</code> 参数；如果没有配置 <code>chInfo</code> 参数，但是配置了 <code>appId</code> 参数，则使用 <code>appId</code> 构造 <code>chInfo</code> 参数：<code>ch_[appId]</code>；否则，不带 <code>chInfo</code> 参数。</p></li> <li><p><strong>示例：</strong></p> <div class="language-ts line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> setupPage<span class="token punctuation">,</span> usePlugins <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@alipay/goldfish'</span><span class="token punctuation">;</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token function">setupPage</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> plugins <span class="token operator">=</span> <span class="token function">usePlugins</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  plugins<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span><span class="token function">pushWindow</span><span class="token punctuation">(</span><span class="token string">'https://render.alipay.com/p/f/fd-jx2w06zl/index.html?chInfo=ch_internal__chsub_huodongyemian__zidingyi_pmp_mp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul> <h3 id="getcurrentlocation-options"><a href="#getcurrentlocation-options" class="header-anchor">#</a> getCurrentLocation(options)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{Object} options</code></li></ul></li> <li><p><strong>返回值：</strong><code>{Promise&lt;Object&gt;} location</code></p></li> <li><p><strong>说明：</strong></p> <p>获取定位。</p> <p><code>options</code> 参数参考<a href="https://docs.alipay.com/mini/api/mkxuqd#upyir" target="_blank" rel="noopener noreferrer">官方 API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>返回的定位信息格式参考<a href="https://docs.alipay.com/mini/api/mkxuqd#success-%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0" target="_blank" rel="noopener noreferrer">官方 API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>如果当前页面参数上携带了定位信息，则此处会直接返回该定位信息，这样做主要是为了方便程序化地在多台设备上跑兼容性测试。</p></div></li></ul> <h3 id="getstartupparams-options"><a href="#getstartupparams-options" class="header-anchor">#</a> getStartupParams(options?)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{Object} options?</code></li></ul></li> <li><p><strong>返回值：</strong><code>{Promise&lt;Object&gt;}</code></p></li> <li><p><strong>说明：</strong></p> <p>对官方 API 的封装，参数和返回值格式都可以参考<a href="http://jsapi.alipay.net/jsapi/util/get-startup-params.html" target="_blank" rel="noopener noreferrer">官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="reportbizready"><a href="#reportbizready" class="header-anchor">#</a> reportBizReady()</h3> <ul><li><p><strong>说明：</strong></p> <p>上报心跳，参考<a href="https://yuque.antfin-inc.com/hybridinspect/stargazer/heartbeats" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>在全局模块中，完成初始化之后，会调用一次该方法，不需要手动调用。</p></div></li></ul> <h3 id="getuserinfo"><a href="#getuserinfo" class="header-anchor">#</a> getUserInfo()</h3> <ul><li><p><strong>说明：</strong></p> <p>获取用户信息，参考<a href="http://jsapi.alipay.net/jsapi/util/get-user-info.html" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="getsysteminfo"><a href="#getsysteminfo" class="header-anchor">#</a> getSystemInfo()</h3> <ul><li><p><strong>说明：</strong></p> <p>获取系统信息，参考<a href="https://docs.alipay.com/mini/api/system-info" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="getnetworktype"><a href="#getnetworktype" class="header-anchor">#</a> getNetworkType()</h3> <ul><li><p><strong>说明：</strong></p> <p>获取网络信息，参考<a href="https://docs.alipay.com/mini/api/network-status" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="getstorageitem-key"><a href="#getstorageitem-key" class="header-anchor">#</a> getStorageItem(key)</h3> <ul><li><p><strong>说明：</strong></p> <p>获取本地存储数据，底层使用的是 <a href="https://docs.alipay.com/mini/api/azfobl" target="_blank" rel="noopener noreferrer">my.getStorage<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="setstorageitem-key-value"><a href="#setstorageitem-key-value" class="header-anchor">#</a> setStorageItem(key, value)</h3> <ul><li><p><strong>说明：</strong></p> <p>存储数据到本地，底层使用的是 <a href="https://docs.alipay.com/mini/api/eocm6v" target="_blank" rel="noopener noreferrer">my.setStorage<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="getcurrenturl"><a href="#getcurrenturl" class="header-anchor">#</a> getCurrentUrl()</h3> <ul><li><p><strong>说明：</strong></p> <p>获取当前页面的 URL 地址，拿到的地址格式与 <code>app.json</code> 中配置的一样。</p></li></ul> <h3 id="callbridge-api-args"><a href="#callbridge-api-args" class="header-anchor">#</a> callBridge(api, ...args?)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string} api</code></li> <li><code>{Array} args?</code> <ul><li><code>{Object | Function} args[0]</code></li> <li><code>{Function} args[1]</code></li></ul></li></ul></li> <li><p><strong>说明：</strong></p> <p>对 <a href="https://docs.antfin.com/tinyapp/develop/api" target="_blank" rel="noopener noreferrer">my.call<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的封装。</p></li></ul> <h2 id="feedback-交互反馈插件"><a href="#feedback-交互反馈插件" class="header-anchor">#</a> Feedback 交互反馈插件</h2> <p>管理全局的 alert、toast、confirm、prompt 弹窗。</p> <p>为了避免同一个时刻弹出多个全局弹窗，本模块做了可选的“串行”控制：前一个弹窗未消失之前，下一个弹窗不会弹出。</p> <h3 id="addtoast-options"><a href="#addtoast-options" class="header-anchor">#</a> addToast(options)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{Object} options</code> <ul><li><code>{number} duration?</code> 显示时长，单位为 ms，默认 2000</li> <li><code>{string} content?</code> 内容</li> <li><code>{Function} complete?</code> 显示结束后的回调函数</li> <li><code>{boolean} isBlock?</code> 是否阻塞下一个弹窗</li></ul></li></ul></li> <li><p><strong>说明：</strong></p> <p>显示 toast 弹窗。</p></li></ul> <h3 id="addalert-options"><a href="#addalert-options" class="header-anchor">#</a> addAlert(options)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{Object} options</code> <ul><li><code>{string} title?</code> 标题</li> <li><code>{string} buttonText?</code> 按钮文字，默认为“确定”</li> <li><code>{string} content?</code> 内容</li> <li><code>{Function} complete?</code> 显示结束后的回调函数</li> <li><code>{boolean} isBlock?</code> 是否阻塞下一个弹窗</li></ul></li></ul></li> <li><p><strong>说明：</strong></p> <p>显示 alert 弹窗。</p></li></ul> <h3 id="addconfirm-options"><a href="#addconfirm-options" class="header-anchor">#</a> addConfirm(options)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{Object} options</code> <ul><li><code>{string} title?</code> 标题</li> <li><code>{string} okButtonText?</code> 确认按钮文字，默认为“确定”</li> <li><code>{string} cancelButtonText?</code> 取消按钮文字，默认为“取消”</li> <li><code>{string} content?</code> 内容</li> <li><code>{Function} complete?</code> 显示结束后的回调函数</li> <li><code>{boolean} isBlock?</code> 是否阻塞下一个弹窗</li></ul></li></ul></li> <li><p><strong>说明：</strong></p> <p>显示 confirm 弹窗。</p></li></ul> <h3 id="addprompt-options"><a href="#addprompt-options" class="header-anchor">#</a> addPrompt(options)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{Object} options</code> <ul><li><code>{string} title?</code> 标题</li> <li><code>{string} okButtonText?</code> 确认按钮文字，默认为“确定”</li> <li><code>{string} cancelButtonText?</code> 取消按钮文字，默认为“取消”</li> <li><code>{string} content?</code> 内容</li> <li><code>{Function} complete?</code> 显示结束后的回调函数</li> <li><code>{boolean} isBlock?</code> 是否阻塞下一个弹窗</li></ul></li></ul></li> <li><p><strong>说明：</strong></p> <p>显示 prompt 弹窗。</p></li></ul> <h2 id="requester-数据请求插件"><a href="#requester-数据请求插件" class="header-anchor">#</a> Requester 数据请求插件</h2> <p>主要处理三种类型的请求：</p> <ul><li>HTTP 请求；</li> <li>RPC 数据请求；</li> <li>凤蝶区块数据请求。</li></ul> <p>如果全局配置中，<code>mock</code> 配置项为 <code>true</code>，数据请求将会被定向到指定服务器（<code>mockServer</code>）。</p> <h3 id="requesttwa-api-params-options"><a href="#requesttwa-api-params-options" class="header-anchor">#</a> requestTWA(api, params?, options?)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string} api</code> 要请求的 TWA 接口地址</li> <li><code>{Object} params?</code> 请求参数</li> <li><code>{Object} options?</code> <ul><li><code>{boolean} showLoading?</code> 是否展示加载效果</li> <li><code>{number} delay?</code> 延迟多长时间才展示加载效果</li> <li><code>{boolean} needAuthorized?</code> 是否需要登录验证</li> <li><code>{number} timeout?</code> 请求超时时间</li> <li><code>{string} forward?</code> 将请求定位到指定的机器</li></ul></li></ul></li> <li><p><strong>返回值：</strong><code>{Promise&lt;T&gt;}</code></p></li> <li><p><strong>说明：</strong></p> <p>请求 TWA 应用接口。</p></li> <li><p><strong>示例：</strong></p> <div class="language-ts line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> setupPage<span class="token punctuation">,</span> usePlugins<span class="token punctuation">,</span> usePageLifeCycle <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@alipay/goldfish'</span><span class="token punctuation">;</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> plugins <span class="token operator">=</span> <span class="token function">usePlugins</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">usePageLifeCycle</span><span class="token punctuation">(</span><span class="token string">'onLoadReady'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> plugins<span class="token punctuation">.</span>requester<span class="token punctuation">.</span>requestTWA<span class="token operator">&lt;</span>IListResponse<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">'passion.index.list'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li></ul> <h3 id="requesth5data-path-basementprojectname-options"><a href="#requesth5data-path-basementprojectname-options" class="header-anchor">#</a> requestH5Data(path, basementProjectName, options?)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string} path</code> schema 文件在项目中的路径</li> <li><code>{string} basementProjectName</code> 对应 Basement 上凤蝶区块项目名称</li> <li><code>{Object} options?</code> <ul><li><code>{boolean} showLoading?</code> 是否展示加载效果</li> <li><code>{number} delay?</code> 延迟多长时间才展示加载效果</li></ul></li></ul></li> <li><p><strong>说明：</strong></p> <p>请求凤蝶区块数据。</p></li> <li><p><strong>示例：</strong></p> <div class="language-ts line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> setupPage<span class="token punctuation">,</span> usePlugins<span class="token punctuation">,</span> usePageLifeCycle <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@alipay/goldfish'</span><span class="token punctuation">;</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> plugins <span class="token operator">=</span> <span class="token function">usePlugins</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">usePageLifeCycle</span><span class="token punctuation">(</span><span class="token string">'onLoadReady'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> plugins<span class="token punctuation">.</span>requester<span class="token punctuation">.</span>requestH5Data<span class="token operator">&lt;</span>IConfigData<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">'config-h5data'</span><span class="token punctuation">,</span> <span class="token string">'device'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li></ul> <h3 id="sendrequest-url"><a href="#sendrequest-url" class="header-anchor">#</a> sendRequest(url)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string} url</code> HTTP 请求地址</li></ul></li> <li><p><strong>说明：</strong></p> <p>发送 HTTP GET 请求到指定地址，不在乎响应结果。</p></li></ul> <h2 id="route-应用内路由插件"><a href="#route-应用内路由插件" class="header-anchor">#</a> Route 应用内路由插件</h2> <p>处理应用内的路由跳转。</p> <h3 id="path"><a href="#path" class="header-anchor">#</a> path</h3> <ul><li><p><strong>类型：</strong><code>{string}</code></p></li> <li><p><strong>说明：</strong></p> <p>小程序当前页面的地址，格式与 <code>app.json</code> 中配置的 pages 一致。</p></li></ul> <h3 id="query"><a href="#query" class="header-anchor">#</a> query</h3> <ul><li><p><strong>类型：</strong><code>{Object}</code></p></li> <li><p><strong>说明：</strong></p> <p>小程序当前页面所携带的参数，与 <a href="https://docs.alipay.com/mini/framework/page-detail#onloadquery-object" target="_blank" rel="noopener noreferrer">Page#onLoad<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 中传入 query 参数一致。</p></li></ul> <h3 id="redirect-url-params"><a href="#redirect-url-params" class="header-anchor">#</a> redirect(url, params?)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string} url</code></li> <li><code>{Object} params</code></li></ul></li> <li><p><strong>说明：</strong></p> <p>关闭当前页面，进入到 <code>url</code> 参数指定的页面。</p></li></ul> <h3 id="back-n-defaulturl"><a href="#back-n-defaulturl" class="header-anchor">#</a> back(n, defaultUrl?)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{number} n</code></li> <li><code>{string} defaultUrl?</code></li></ul></li> <li><p><strong>说明：</strong></p> <p>删除页面堆栈栈顶 <code>n</code> 个元素，然后跳转到当前栈顶标识的页面。如果 <code>n</code> 大于等于数组长度，那么会跳转到 <code>defaultUrl</code> 所示地址（默认 <code>/</code>），压入页面栈。</p></li></ul> <h3 id="backto-url-options"><a href="#backto-url-options" class="header-anchor">#</a> backTo(url, options?)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string} url</code></li> <li><code>{Object} options</code> <ul><li><code>{number} removeStackLength</code></li> <li><code>{Object} params</code></li></ul></li></ul></li> <li><p><strong>说明：</strong></p> <p>从页面堆栈栈顶开始，删除 <code>options.removeStackLength</code> 个元素，如果 <code>options.removeStackLength</code> 超过页面堆栈长度，则会移除所有元素。移除结束后，使用 <code>url</code> 与 <code>options.params</code> 整合成新的页面地址，跳转至该地址，并压入页面栈。</p></li></ul> <h3 id="replace-url-params"><a href="#replace-url-params" class="header-anchor">#</a> replace(url, params?)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string} url</code></li> <li><code>{Object} params?</code></li></ul></li> <li><p><strong>说明：</strong></p> <p>移除页面堆栈中所有元素，将当前页面地址置为 url 和 params 所标识的页面地址，并压入页面堆栈。</p></li></ul> <h3 id="pushwindow-url-params-2"><a href="#pushwindow-url-params-2" class="header-anchor">#</a> pushWindow(url, params?)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string} url</code></li> <li><code>{Object} params?</code></li></ul></li> <li><p><strong>说明：</strong></p> <p>新建“标签页”，将其地址置为 <code>url</code> 和 <code>params</code> 所标识的地址。</p></li></ul> <h3 id="popwindow"><a href="#popwindow" class="header-anchor">#</a> popWindow()</h3> <ul><li><p><strong>说明：</strong></p> <p>删除当前“标签页”，回到上一个“标签页”。如果没有“上一个标签页”，则返回到首页。</p></li></ul> <h3 id="popto-delta"><a href="#popto-delta" class="header-anchor">#</a> popTo(delta)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{number} delta</code></li></ul></li> <li><p><strong>说明：</strong></p> <p>删除 delta 个“标签页”。如果溢出，则返回到首页。</p></li></ul> <h2 id="trace-业务埋点插件"><a href="#trace-业务埋点插件" class="header-anchor">#</a> Trace 业务埋点插件</h2> <p>上报业务埋点。</p> <h3 id="logpv-spmb-params"><a href="#logpv-spmb-params" class="header-anchor">#</a> logPv(spmb, params?)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string} spmb</code></li> <li><code>{Object} params?</code></li></ul></li> <li><p><strong>说明：</strong></p> <p>切换 b 位，可以附带 <code>params</code> 作为参数。</p></li></ul> <h3 id="before-name-hookfn"><a href="#before-name-hookfn" class="header-anchor">#</a> before(name, hookFn)</h3> <ul><li><p><strong>说明：</strong></p> <p>参考<a href="https://yuque.antfin-inc.com/tracert/3.0/gr89zc#before" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="call-methodname-args"><a href="#call-methodname-args" class="header-anchor">#</a> call(methodName, ...args)</h3> <ul><li><p><strong>说明：</strong></p> <p>参考<a href="https://yuque.antfin-inc.com/tracert/3.0/sv87oe#u8guue" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="report-params"><a href="#report-params" class="header-anchor">#</a> report(params)</h3> <ul><li><p><strong>说明：</strong></p> <p>参考<a href="https://yuque.antfin-inc.com/tracert/3.0/sv87oe#kwaeml" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="get-key"><a href="#get-key" class="header-anchor">#</a> get(key)</h3> <ul><li><p><strong>说明：</strong></p> <p>参考<a href="https://yuque.antfin-inc.com/tracert/3.0/sv87oe#sgzbbs" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="set-config"><a href="#set-config" class="header-anchor">#</a> set(config)</h3> <ul><li><p><strong>说明：</strong></p> <p>参考<a href="https://yuque.antfin-inc.com/tracert/3.0/sv87oe#qls5yx" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="click-spmid-extraparams"><a href="#click-spmid-extraparams" class="header-anchor">#</a> click(spmId, extraParams?)</h3> <ul><li><p><strong>说明：</strong></p> <p>参考<a href="https://yuque.antfin-inc.com/tracert/3.0/sv87oe#3n56mz" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="expo-spmid-extraparams"><a href="#expo-spmid-extraparams" class="header-anchor">#</a> expo(spmId, extraParams?)</h3> <ul><li><p><strong>说明：</strong></p> <p>参考<a href="https://yuque.antfin-inc.com/tracert/3.0/sv87oe#fyugez" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="pagestate-name"><a href="#pagestate-name" class="header-anchor">#</a> pageState(name)</h3> <ul><li><p><strong>说明：</strong></p> <p>参考<a href="https://yuque.antfin-inc.com/tracert/3.0/sv87oe#5bghrf" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="info-params"><a href="#info-params" class="header-anchor">#</a> info(params)</h3> <ul><li><p><strong>说明：</strong></p> <p>参考<a href="https://yuque.antfin-inc.com/tracert/3.0/sv87oe#wkcscg" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="parse-value"><a href="#parse-value" class="header-anchor">#</a> parse(value)</h3> <ul><li><p><strong>说明：</strong></p> <p>参考<a href="https://yuque.antfin-inc.com/tracert/3.0/sv87oe#9d9yrl" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h3 id="stringify-value"><a href="#stringify-value" class="header-anchor">#</a> stringify(value)</h3> <ul><li><p><strong>说明：</strong></p> <p>参考<a href="https://yuque.antfin-inc.com/tracert/3.0/sv87oe#2qy2xa" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li></ul> <h2 id="log-日志插件"><a href="#log-日志插件" class="header-anchor">#</a> Log 日志插件</h2> <p>日志模块管理前端日志，可以将前端日志发送到指定服务器。</p> <p>在本地开发时，日志会打印到控制台；部署之后，会将日志发送给服务器。当然，也可以实现自己的日志类，在线上环境不发送任何日志信息。</p> <h3 id="log-msg"><a href="#log-msg" class="header-anchor">#</a> log(msg)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string} msg</code></li></ul></li> <li><p><strong>说明：</strong></p> <p>输出 log 级别的日志。</p></li></ul> <h3 id="warn-msg"><a href="#warn-msg" class="header-anchor">#</a> warn(msg)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string | Error} msg</code></li></ul></li> <li><p><strong>说明：</strong></p> <p>输出 warn 级别的日志。</p></li></ul> <h3 id="debug-msg"><a href="#debug-msg" class="header-anchor">#</a> debug(msg)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string | Error} msg</code></li></ul></li> <li><p><strong>说明：</strong></p> <p>输出 debug 级别的日志。</p></li></ul> <h3 id="error-msg"><a href="#error-msg" class="header-anchor">#</a> error(msg)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{string | Error} msg</code></li></ul></li> <li><p><strong>说明：</strong></p> <p>输出 error 级别的日志。</p></li></ul> <h3 id="reportduration-type-name-fn"><a href="#reportduration-type-name-fn" class="header-anchor">#</a> reportDuration(type, name, fn)</h3> <ul><li><p><strong>参数：</strong></p> <ul><li><code>{'h5' | 'rpc' | 'h5data'} type</code></li> <li><code>{string} name</code></li> <li><code>{() =&gt; Promise&lt;R&gt;} fn</code></li></ul></li> <li><p><strong>返回值：</strong><code>Promise&lt;R&gt;</code></p></li> <li><p><strong>说明：</strong></p> <p>输出 <code>fn</code> 调用耗时日志，并会附带上一系列系统信息。</p></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/goldfish/zh/api/Component.html" class="prev">组件</a></span> <span class="next"><a href="/goldfish/zh/api/utils.html">工具函数</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/goldfish/assets/js/app.1d07effa.js" defer></script><script src="/goldfish/assets/js/3.ecc071d1.js" defer></script><script src="/goldfish/assets/js/52.1266f369.js" defer></script>
  </body>
</html>
